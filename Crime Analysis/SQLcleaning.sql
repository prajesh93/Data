USE [Crime12]
GO
/***** Object:  Table [dbo].[Crime123]    Script Date: 8/5/2016 7:37:39 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Crime123](
	[INCIDENT_ID] [varchar](50) NULL,
	[OFFENSE_ID] [varchar](50) NULL,
	[OFFENSE_CODE] [varchar](50) NULL,
	[FIRST_OCCURENCE_DATE] [varchar](50) NULL,
	[FIRST_OCCURENCE_TIME] [varchar](50) NULL,
	[REPORTED_DATE] [varchar](50) NULL,
	[GEO_X] [varchar](50) NULL,
	[GEO_Y] [varchar](50) NULL,
	[GEO_LON] [varchar](50) NULL,
	[GEO_LAT] [varchar](50) NULL,
	[DISTRICT_ID] [varchar](50) NULL,
	[PRECINCT_ID] [varchar](50) NULL,
	[NEIGHBORHOOD_ID] [varchar](50) NULL
) ON [PRIMARY]

GO

SELECT [INCIDENT_ID]
      ,[OFFENSE_ID]
      ,[OFFENSE_CODE]
      ,[FIRST_OCCURENCE_DATE]
      ,[FIRST_OCCURENCE_TIME]
      ,[REPORTED_DATE]
      ,[GEO_X]
      ,[GEO_Y]
      ,[GEO_LON]
      ,[GEO_LAT]
      ,[DISTRICT_ID]
      ,[PRECINCT_ID]
      ,[NEIGHBORHOOD_ID]
  FROM [dbo].[Crime123]
GO

SELECT COUNT(*) FROM Crime123;
GO
UPDATE Crime123
SET GEO_X='3133618',GEO_Y='1682655',GEO_LON='-105.0250898',GEO_LAT='39.7067304'
WHERE NEIGHBORHOOD_ID='athmar-park' AND GEO_X='0';

UPDATE Crime123
SET GEO_LON='-104.9926186',GEO_LAT='39.6978043',DISTRICT_ID='4',PRECINCT_ID='412'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='athmar-park';

UPDATE Crime123
SET GEO_X='3140752',GEO_Y='1695247',GEO_LON='-104.9994878',GEO_LAT='39.7411928'
WHERE NEIGHBORHOOD_ID='auraria' AND GEO_X='0';

UPDATE Crime123
SET GEO_LON='-104.9994878',GEO_LAT='39.7411928',DISTRICT_ID='1',PRECINCT_ID='123'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='auraria';

UPDATE Crime123
SET GEO_X='3144173',GEO_Y='1689600',GEO_LON='-104.9874363',GEO_LAT='39.7256384'
WHERE NEIGHBORHOOD_ID='baker' AND GEO_X='0';

UPDATE Crime123
SET GEO_LON='-104.9874363',GEO_LAT='39.7256384',DISTRICT_ID='3',PRECINCT_ID='311'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='baker';

UPDATE Crime123
SET GEO_X='3133602',GEO_Y='1686265',GEO_LON='-105.0250796',GEO_LAT='39.7166408'
WHERE NEIGHBORHOOD_ID='barnum' AND GEO_X='0';
			
UPDATE Crime123
SET GEO_LON='-105.0250796',GEO_LAT='39.7166408',DISTRICT_ID='4',PRECINCT_ID='411'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='barnum';


UPDATE Crime123
SET GEO_X='3129541',GEO_Y='1689547',GEO_LON='-105.039456',GEO_LAT='39.725708'
WHERE NEIGHBORHOOD_ID='barnum-west' AND GEO_X='0';
			
UPDATE Crime123
SET GEO_LON='-105.039456',GEO_LAT='39.725708',DISTRICT_ID='4',PRECINCT_ID='411'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='barnum-west';

UPDATE Crime123
SET GEO_X='3125806',GEO_Y='1663314',GEO_LON='-105.0531931',GEO_LAT='39.6537488'
WHERE NEIGHBORHOOD_ID='bear-valley' AND GEO_X='0';
	
UPDATE Crime123
SET GEO_LON='-105.0531931',GEO_LAT='39.6537488',DISTRICT_ID='4',PRECINCT_ID='423'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='bear-valley';

UPDATE Crime123
SET GEO_X='3157728',GEO_Y='1679500',GEO_LON='-104.9394683',GEO_LAT='39.697692'
WHERE NEIGHBORHOOD_ID='belcaro' AND GEO_X='0';


UPDATE Crime123
SET GEO_LON='-104.9394683',GEO_LAT='39.697692',DISTRICT_ID='3',PRECINCT_ID='312'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='belcaro';

UPDATE Crime123
SET GEO_X='3133444',GEO_Y='1710771',GEO_LON='-105.025186',GEO_LAT='39.7839164'
WHERE NEIGHBORHOOD_ID='berkeley' AND GEO_X='0';
		

UPDATE Crime123
SET GEO_LON='-105.025186',GEO_LAT='39.7839164',DISTRICT_ID='1',PRECINCT_ID='111'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='berkeley';

UPDATE Crime123
SET GEO_X='3148244',GEO_Y='1690876',GEO_LON='-104.9729371',GEO_LAT='39.7290773'
WHERE NEIGHBORHOOD_ID='capitol-hill' AND GEO_X='0';
		

UPDATE Crime123
SET GEO_LON='-104.9729371',GEO_LAT='39.7290773',DISTRICT_ID='6',PRECINCT_ID='623'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='capitol-hill';

UPDATE Crime123
SET GEO_X='3144153',GEO_Y='1696054',GEO_LON='-104.987378',GEO_LAT='39.7433561'
WHERE NEIGHBORHOOD_ID='cbd' AND GEO_X='0';
		

UPDATE Crime123
SET GEO_LON='-104.987378',GEO_LAT='39.7433561',DISTRICT_ID='6',PRECINCT_ID='611'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='cbd';

UPDATE Crime123
SET GEO_X='3140825',GEO_Y='1710641',GEO_LON='-104.9989263',GEO_LAT='39.7834507'
WHERE NEIGHBORHOOD_ID='chaffee-park' AND GEO_X='0';
		
			

UPDATE Crime123
SET GEO_LON='-104.9989263',GEO_LAT='39.7834507',DISTRICT_ID='1',PRECINCT_ID='111'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='chaffee-park';

UPDATE Crime123
SET GEO_X='3151925',GEO_Y='1694289',GEO_LON='-104.9597779',GEO_LAT='39.7383872'
WHERE NEIGHBORHOOD_ID='cheesman-park' AND GEO_X='0';
		
UPDATE Crime123
SET GEO_LON='-104.9729261',GEO_LAT='39.737637',DISTRICT_ID='6',PRECINCT_ID='622'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='cheesman-park';

			

					
UPDATE Crime123
SET GEO_X='3157351',GEO_Y='1685095',GEO_LON='-104.9406857',GEO_LAT='39.7130578'
WHERE NEIGHBORHOOD_ID='cherry-creek' AND GEO_X='0';
		
UPDATE Crime123
SET GEO_LON='-104.9406857',GEO_LAT='39.7130578',DISTRICT_ID='3',PRECINCT_ID='312'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='cherry-creek';

	
UPDATE Crime123
SET GEO_X='3157288',GEO_Y='1697601',GEO_LON='-104.9406359',GEO_LAT='39.7473901'
WHERE NEIGHBORHOOD_ID='city-park' AND GEO_X='0';
		
UPDATE Crime123
SET GEO_LON='-104.9406359',GEO_LAT='39.7473901',DISTRICT_ID='2',PRECINCT_ID='213'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='city-park';
	

UPDATE Crime123
SET GEO_X='3151905',GEO_Y='1698321',GEO_LON='-104.9597638',GEO_LAT='39.7494561'
WHERE NEIGHBORHOOD_ID='city-park-west' AND GEO_X='0';
		
UPDATE Crime123
SET GEO_LON='-104.9597638',GEO_LAT='39.7494561',DISTRICT_ID='6',PRECINCT_ID='622'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='city-park-west';

UPDATE Crime123
SET GEO_X='3144156',GEO_Y='1694853',GEO_LON='-104.9873914',GEO_LAT='39.7400591'
WHERE NEIGHBORHOOD_ID='civic-center' AND GEO_X='0';
		
UPDATE Crime123
SET GEO_LON='-104.9873914',GEO_LAT='39.7400591',DISTRICT_ID='6',PRECINCT_ID='611'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='civic-center';

			
UPDATE Crime123
SET GEO_X='3157268',GEO_Y='1703824',GEO_LON='-104.9405707',GEO_LAT='39.7644736'
WHERE NEIGHBORHOOD_ID='clayton' AND GEO_X='0';
		
UPDATE Crime123
SET GEO_LON='-104.9405707',GEO_LAT='39.7644736',DISTRICT_ID='2',PRECINCT_ID='212'
WHERE PRECINCT_ID='' AND NEIGHBORHOOD_ID='clayton';
GO

CREATE VIEW Cri AS
SELECT NEIGHBORHOOD_ID, COUNT(INCIDENT_ID) AS TOTAL_INCIDENTS
FROM Crime123
GROUP BY NEIGHBORHOOD_ID;


Select NEIGHBORHOOD_ID, TOTAL_INCIDENTS
FROM Cri
WHERE TOTAL_INCIDENTS=(SELECT MAX(TOTAL_INCIDENTS) FROM Cri);

GO